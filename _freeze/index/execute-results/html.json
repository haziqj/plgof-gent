{
  "hash": "32ba87af2adc359e8e92b70c29b7696b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Weighted pairwise likelihood and limited information goodness-of-fit tests for binary factor models\"\nsubtitle: \"Adolphe Quetelet Seminar Series, Ghent University\"\nauthor:\n  - name: Haziq Jamil\n    orcid: 0000-0003-3298-1010\n    affiliations: \n      - 'Assistant Professor in Statistics, Universiti Brunei Darussalam<br>Visiting Fellow, London School of Economics and Political Science'\n      - '<span style=\"font-style:normal;\">[`https://haziqj.ml/pligof-gent/`](https://haziqj.ml/pligof-gent/)</span>'\ndate: \"15 April 2024\"\n---\n\n::: {.cell}\n\n:::\n\n\\renewcommand{\\Pr}{\\operatorname{P}}\n\\newcommand{\\pimod}[1]{\\pi_{#1}(\\btheta)}\n\\newcommand{\\pL}{\\operatorname{\\mathcal L_{\\text P}}}\n\\newcommand{\\pl}{\\operatorname{\\ell_P}}\n\\newcommand{\\mlepl}{\\hat\\btheta_{\\text{PL}}}\n\\newcommand{\\pimodpl}{\\pi_{y_iy_j}^{(ij)}(\\btheta)}\n\\newcommand{\\bzero}{{\\mathbf 0}}\n\\newcommand{\\bone}{{\\mathbf 1}}\n\\newcommand{\\ba}{{\\mathbf a}}\n\\newcommand{\\bb}{{\\mathbf b}}\n\\newcommand{\\bc}{{\\mathbf c}}\n\\newcommand{\\bd}{{\\mathbf d}}\n\\newcommand{\\be}{{\\mathbf e}}\n\\newcommand{\\bff}{{\\mathbf f}}\n\\newcommand{\\bg}{{\\mathbf g}}\n\\newcommand{\\bh}{{\\mathbf h}}\n\\newcommand{\\bi}{{\\mathbf i}}\n\\newcommand{\\bj}{{\\mathbf j}}\n\\newcommand{\\bk}{{\\mathbf k}}\n\\newcommand{\\bl}{{\\mathbf l}}\n\\newcommand{\\bmm}{{\\mathbf m}}\n\\newcommand{\\bn}{{\\mathbf n}}\n\\newcommand{\\bo}{{\\mathbf o}}\n\\newcommand{\\bp}{{\\mathbf p}}\n\\newcommand{\\bq}{{\\mathbf q}}\n\\newcommand{\\br}{{\\mathbf r}}\n\\newcommand{\\bs}{{\\mathbf s}}\n\\newcommand{\\bt}{{\\mathbf t}}\n\\newcommand{\\bu}{{\\mathbf u}}\n\\newcommand{\\bv}{{\\mathbf v}}\n\\newcommand{\\bw}{{\\mathbf w}}\n\\newcommand{\\bx}{{\\mathbf x}}\n\\newcommand{\\by}{{\\mathbf y}}\n\\newcommand{\\bz}{{\\mathbf z}}\n\\newcommand{\\bA}{{\\mathbf A}}\n\\newcommand{\\bB}{{\\mathbf B}}\n\\newcommand{\\bC}{{\\mathbf C}}\n\\newcommand{\\bD}{{\\mathbf D}}\n\\newcommand{\\bE}{{\\mathbf E}}\n\\newcommand{\\bF}{{\\mathbf F}}\n\\newcommand{\\bG}{{\\mathbf G}}\n\\newcommand{\\bH}{{\\mathbf H}}\n\\newcommand{\\bI}{{\\mathbf I}}\n\\newcommand{\\bJ}{{\\mathbf J}}\n\\newcommand{\\bK}{{\\mathbf K}}\n\\newcommand{\\bL}{{\\mathbf L}}\n\\newcommand{\\bM}{{\\mathbf M}}\n\\newcommand{\\bN}{{\\mathbf N}}\n\\newcommand{\\bO}{{\\mathbf O}}\n\\newcommand{\\bP}{{\\mathbf P}}\n\\newcommand{\\bQ}{{\\mathbf Q}}\n\\newcommand{\\bR}{{\\mathbf R}}\n\\newcommand{\\bS}{{\\mathbf S}}\n\\newcommand{\\bT}{{\\mathbf T}}\n\\newcommand{\\bU}{{\\mathbf U}}\n\\newcommand{\\bV}{{\\mathbf V}}\n\\newcommand{\\bW}{{\\mathbf W}}\n\\newcommand{\\bX}{{\\mathbf X}}\n\\newcommand{\\bY}{{\\mathbf Y}}\n\\newcommand{\\bZ}{{\\mathbf Z}}\n\\newcommand{\\balpha}{{\\boldsymbol\\alpha}}\n\\newcommand{\\bbeta}{{\\boldsymbol\\beta}}\n\\newcommand{\\bgamma}{{\\boldsymbol\\gamma}}\n\\newcommand{\\bdelta}{{\\boldsymbol\\delta}}\n\\newcommand{\\bepsilon}{{\\boldsymbol\\epsilon}}\n\\newcommand{\\bvarepsilon}{{\\boldsymbol\\varepsilon}}\n\\newcommand{\\bzeta}{{\\boldsymbol\\zeta}}\n\\newcommand{\\bfeta}{{\\boldsymbol\\eta}}\n\\newcommand{\\boldeta}{{\\boldsymbol\\eta}}\n\\newcommand{\\btheta}{{\\boldsymbol\\theta}}\n\\newcommand{\\bvartheta}{{\\boldsymbol\\vartheta}}\n\\newcommand{\\biota}{{\\boldsymbol\\iota}}\n\\newcommand{\\bkappa}{{\\boldsymbol\\kappa}}\n\\newcommand{\\blambda}{{\\boldsymbol\\lambda}}\n\\newcommand{\\bmu}{{\\boldsymbol\\mu}}\n\\newcommand{\\bnu}{{\\boldsymbol\\nu}}\n\\newcommand{\\bxi}{{\\boldsymbol\\xi}}\n\\newcommand{\\bpi}{{\\boldsymbol\\pi}}\n\\newcommand{\\bvarpi}{{\\boldsymbol\\varpi}}\n\\newcommand{\\brho}{{\\boldsymbol\\rho}}\n\\newcommand{\\bvarrho}{{\\boldsymbol\\varrho}}\n\\newcommand{\\bsigma}{{\\boldsymbol\\sigma}}\n\\newcommand{\\bvarsigma}{{\\boldsymbol\\varsigma}}\n\\newcommand{\\btau}{{\\boldsymbol\\tau}}\n\\newcommand{\\bupsilon}{{\\boldsymbol\\upsilon}}\n\\newcommand{\\bphi}{{\\boldsymbol\\phi}}\n\\newcommand{\\bvarphi}{{\\boldsymbol\\varphi}}\n\\newcommand{\\bchi}{{\\boldsymbol\\chi}}\n\\newcommand{\\bpsi}{{\\boldsymbol\\psi}}\n\\newcommand{\\bomega}{{\\boldsymbol\\omega}}\n\\newcommand{\\bGamma}{{\\boldsymbol\\Gamma}}\n\\newcommand{\\bDelta}{{\\boldsymbol\\Delta}}\n\\newcommand{\\bTheta}{{\\boldsymbol\\Theta}}\n\\newcommand{\\bLambda}{{\\boldsymbol\\Lambda}}\n\\newcommand{\\bXi}{{\\boldsymbol\\Xi}}\n\\newcommand{\\bPi}{{\\boldsymbol\\Pi}}\n\\newcommand{\\bSigma}{{\\boldsymbol\\Sigma}}\n\\newcommand{\\bUpsilon}{{\\boldsymbol\\Upsilon}}\n\\newcommand{\\bPhi}{{\\boldsymbol\\Phi}}\n\\newcommand{\\bPsi}{{\\boldsymbol\\Psi}}\n\\newcommand{\\bOmega}{{\\boldsymbol\\Omega}}\n\\DeclareMathOperator{\\diag}{diag}\n\\DeclareMathOperator{\\Prob}{P}\n\\DeclareMathOperator{\\E}{E}\n\\DeclareMathOperator{\\Var}{Var}\n\\DeclareMathOperator{\\Cov}{Cov}\n\\DeclareMathOperator{\\Corr}{Corr}\n\\DeclareMathOperator{\\sd}{sd}\n\\DeclareMathOperator{\\se}{se}\n\\DeclareMathOperator{\\N}{N}\n\\DeclareMathOperator{\\Bin}{Bin}\n\\DeclareMathOperator{\\Bern}{Bern}\n\\DeclareMathOperator{\\Dir}{Dir}\n\\DeclareMathOperator{\\Wis}{Wis}\n\\DeclareMathOperator{\\logit}{logit}\n\\DeclareMathOperator{\\expit}{expit}\n\\DeclareMathOperator{\\Mult}{Mult}\n\\DeclareMathOperator{\\Cat}{Cat}\n\\DeclareMathOperator{\\Pois}{Poi}\n\\DeclareMathOperator{\\Geom}{Geom}\n\\DeclareMathOperator{\\NBin}{NBin}\n\\DeclareMathOperator{\\Exp}{Exp}\n\\DeclareMathOperator{\\Betadist}{Beta}\n\\DeclareMathOperator{\\Hypergeom}{Hypergeom}\n\\DeclareMathOperator{\\Cauchy}{Cauchy}\n\\DeclareMathOperator{\\hCauchy}{half-Cauchy}\n\\DeclareMathOperator{\\LKJ}{LKJ}\n\\DeclareMathOperator{\\Unif}{Unif}\n\\DeclareMathOperator{\\KL}{KL}\n\\DeclareMathOperator{\\ind}{\\mathds{1}}\n\\newcommand{\\iid}{\\,\\overset{\\text{iid}}{\\sim}\\,}\n\\DeclareMathOperator*{\\plim}{plim}\n\\DeclareMathOperator{\\Lik}{L}\n\\DeclareMathOperator{\\argmax}{argmax}\n\\DeclareMathOperator{\\vecc}{vec}\n\\let\\d\\relax\n\\DeclareMathOperator{\\dd}{d}\n\\newcommand{\\dint}{\\dd\\hspace{0.5pt}\\!}\n\\newcommand{\\d}{\\text{d}}\n\n\\newcommand{\\bbR}{\\mathbb{R}}\n\\newcommand{\\bbN}{\\mathbb{N}}\n\\newcommand{\\bbZ}{\\mathbb{Z}}\n\\newcommand{\\bbC}{\\mathbb{C}}\n\\newcommand{\\bbS}{\\mathbb{S}}\n\\newcommand{\\bbH}{\\mathbb{H}}\n\\newcommand{\\bbP}{\\mathbb{P}}\n\n\\newcommand{\\cA}{{\\mathcal A}}\n\\newcommand{\\cB}{{\\mathcal B}}\n\\newcommand{\\cC}{{\\mathcal C}}\n\\newcommand{\\cD}{{\\mathcal D}}\n\\newcommand{\\cE}{{\\mathcal E}}\n\\newcommand{\\cF}{{\\mathcal F}}\n\\newcommand{\\cG}{{\\mathcal G}}\n\\newcommand{\\cH}{{\\mathcal H}}\n\\newcommand{\\cI}{{\\mathcal I}}\n\\newcommand{\\cJ}{{\\mathcal J}}\n\\newcommand{\\cK}{{\\mathcal K}}\n\\newcommand{\\cL}{{\\mathcal L}}\n\\newcommand{\\cM}{{\\mathcal M}}\n\\newcommand{\\cN}{{\\mathcal N}}\n\\newcommand{\\cO}{{\\mathcal O}}\n\\newcommand{\\cP}{{\\mathcal P}}\n\\newcommand{\\cQ}{{\\mathcal Q}}\n\\newcommand{\\cR}{{\\mathcal R}}\n\\newcommand{\\cS}{{\\mathcal S}}\n\\newcommand{\\cT}{{\\mathcal T}}\n\\newcommand{\\cU}{{\\mathcal U}}\n\\newcommand{\\cV}{{\\mathcal V}}\n\\newcommand{\\cW}{{\\mathcal W}}\n\\newcommand{\\cX}{{\\mathcal X}}\n\\newcommand{\\cY}{{\\mathcal Y}}\n\\newcommand{\\cZ}{{\\mathcal Z}}\n\n\\newcommand{\\myoverbrace}[3][lightgray]{{\\color{#1}\\overbrace{\\color{black}#2}^{#3}}}\n\\newcommand{\\myunderbrace}[3][lightgray]{{\\color{#1}\\underbrace{\\color{black}#2}_{#3}}}\n\n\nSome notes\n\n- Check how to identify source of misfit (I think there's a reference in Olivares paper)\n- Note nomenclature: Pseudo-likelihood, composite likelihood, pairwise likelihood, etc.\n\n# Introduction \n\n## Introduction\n\n::: {.callout-note icon=false title=\"Context\"}\nEmploy latent variable models (factor models) to analyse binary data $y_1,\\dots,y_p$ collected via simple random or complex sampling.\n:::\n\n:::: {.columns}\n\n::: {.column width=\"12.5%\"}\n:::\n\n::: {.column width=\"25%\"}\n![*(Psychometrics)*<br>Behavioural checklist](figures/eg1.jpg)\n:::\n\n::: {.column width=\"25%\"}\n![*(Education)*<br>Achievement test](figures/eg2.jpg)\n:::\n\n::: {.column width=\"25%\"}\n![*(Sociology)*<br>Intergenerational support](figures/eg3.jpg)\n:::\n\n::::\n\n::: {.aside}\nPhoto credits: Unsplash\n[\\@glenncarstenspeters](https://unsplash.com/photos/RLw-UC03Gwc),\n[\\@ivalex](https://unsplash.com/photos/PDRFeeDniCk),\n[\\@oanhmj](https://unsplash.com/photos/8uhVTxlbBd4)\n:::\n\n\n## Introduction (cont.)\n\n::: {.fragment .fade-out fragment-index=1 .absolute left=0 top=80}\n| $i$ | $y_1$ | $y_2$ | $y_3$ | $y_4$ | $y_5$ |\n|:---:|:---:|:---:|:---:|:---:|:---:|\n| 1 | 1 | 0 | 0 | 1 | 1 |\n| 2 | 1 | 1 | 1 | 1 | 1 |\n| 3 | 1 | 1 | 1 | 0 | 1 |\n| $\\vdots$ |  |  | $\\vdots$ |  | |\n| $n$ | 1 | 0 | 0 | 1 | 1 |\n|  |  |  |  |  |  |\n: {.table-ubd}\n:::\n\n::: {.fragment .fade-in-then-out fragment-index=1 .absolute left=0 top=80}\n| $i$ | $y_1$ | $y_2$ | $y_3$ | $y_4$ | $y_5$ | Pattern |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| 1 | 1 | 0 | 0 | 1 | 1 | 10011 |\n| 2 | 1 | 1 | 1 | 1 | 1 | 11111 |\n| 3 | 1 | 1 | 1 | 0 | 1 | 11101 |\n| $\\vdots$ |  |  | $\\vdots$ |  |  | $\\vdots$ |\n| $n$ | 1 | 0 | 0 | 1 | 1 | 10011 |\n|  |  |  |  |  |  |  |\n: {.table-ubd}\n:::\n\n::: {.fragment .fade-in-then-out fragment-index=2 .absolute left=0 top=80}\n| $r$ | $y_1$ | $y_2$ | $y_3$ | $y_4$ | $y_5$ | Pattern | Obs. freq |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| 1 | 1 | 1 | 1 | 1 | 1 | 11111 | 343 |\n| 2 | 1 | 1 | 0 | 1 | 1 | 11011 | 153 |\n| 3 | 1 | 0 | 1 | 1 | 1 | 10111 | 71 |\n| $\\vdots$ |  |  | $\\vdots$ |  |  | $\\vdots$ | $\\vdots$ |\n| $R$ | 0 | 1 | 1 | 1 | 0 | 01110 | 1 |\n|  |  |  |  |  |  |  |  |\n: {.table-ubd }\n:::\n\n::: {.fragment .fade-in-then-out fragment-index=3 .absolute left=0 top=80}\n| $r$ | Pattern | Obs. freq |\n|:---:|:---:|:---:|\n| 1 | 11111 | 343 |\n| 2 | 11011 | 153 |\n| 3 | 10111 | 71 |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 32 | 01110 | 1 |\n|  |  |  |\n: {.table-ubd }\n:::\n\n::: {.fragment .fade-in-then-out fragment-index=4 .absolute left=0 top=80}\n| $r$ | Pattern | Obs. freq | Exp. freq |\n|:---:|:---:|:---:|:---:|\n| 1 | 11111 | 343 | 342.1 |\n| 2 | 11011 | 153 | 151.3 |\n| 3 | 10111 | 71 | 62.81 |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 32 | 01110 | 1 | 0.948 |\n|  |  |  |  |\n: {.table-ubd }\n:::\n\n::: {.fragment .fade-in fragment-index=5 .absolute left=0 top=80}\n| $r$ | Pattern | Obs. freq | Exp. freq |\n|:---:|:---:|:---:|:---:|\n| 1 | 11111 | 343 | 342.1 |\n| 2 | 11011 | 153 | 151.3 |\n| 3 | 10111 | 71 | 62.81 |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 28 | 01110 | [**1**]{.ubdred} | 1.831 |\n| 29 | 01110 | [**1**]{.ubdred} | 3.276 |\n| 30 | 01110 | [**1**]{.ubdred} | 0.948 |\n| 31 | 01110 | [**0**]{.ubdred} | 0.013 |\n| 32 | 01110 | [**0**]{.ubdred} | 0.009 |\n|  |  |  |  |\n: {.table-ubd }\n:::\n\n::: {.absolute left=\"600px\"}\n\n::: {.fragment fragment-index=5}\n- [**Sparsity**]{.ubdred} affects reliability of goodness-of-fit tests.\n  - Limited information tests\n:::\n\n::: {.fragment fragment-index=6}\n\n- Computational burden of likelihood-based models.\n  - Pairwise likelihood\n\n:::\n\n::: {.fragment fragment-index=7}\n\n- Unequal probability sampling (e.g. due to a complex design)\n  - Incorporate design weights\n:::\n\n:::\n\n## Definitions\n\n## Parametric models\n\n## Maximum likelihood estimation\n\n## Pairwise likelihood estimation\n\n## Pairs of variables and pairwise probabilities\n\n# Limited information GOF tests\n\n<!-- ## Goodness-of-fit -->\n\n<!-- ::: {.r-stack} -->\n\n<!-- ::: {.absolute left=0 top=70} -->\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- p_mult_bern_fig + -->\n<!--   ggsankey::theme_sankey() + -->\n<!--   theme( -->\n<!--     legend.position = \"none\", -->\n<!--     plot.margin = unit(c(-0.5,-3.2,0,-3.2), \"cm\") -->\n<!--   ) -->\n<!-- ``` -->\n\n<!-- ::: -->\n\n<!-- ::: {data-id=\"box1\" .fragment .fade-out style=\"background: white; width: 373px; height: 700px;\" .absolute left=125} -->\n<!-- ::: -->\n\n<!-- ::: {data-id=\"box2\" style=\"background: white; width: 800px; height: 700px;\" .absolute left=498} -->\n<!-- ::: -->\n\n<!-- ::: -->\n\n## Goodness-of-fit\n\n::: {.r-stack}\n\n::: {.absolute left=0 top=70}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/mult_bern1.png){width=960}\n:::\n:::\n\n:::\n\n::: {.absolute .fragment fragment-index=1 left=0 top=70}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/mult_bern2.png){width=960}\n:::\n:::\n\n:::\n\n:::: {.absolute left=580 top=70}\n\n::: {.fragment fragment-index=1}\n- GOF tests are usually constructed by inspecting the fit of the joint probabilities $\\hat\\pi_r := \\pi_r(\\hat\\btheta)$.\n:::\n\n::: {.fragment}\n- E.g.\n\n   - LR: $X^2 = 2N\\sum_r \\hat p_r\\log(\\hat p_r/\\hat\\pi_r)$;\n   - Pearson: $X^2 = N\\sum_r (\\hat p_r - \\hat\\pi_r)^2 / \\hat\\pi_r$,\n   \n  These tests are asymptotically distributed as chi square.\n:::\n\n::: {.fragment}\n- Likely to face sparsity issues (small or zero cell counts) which distort the approximation to the chi square.\n:::\n\n::::\n\n:::\n\n## Limited information goodness-of-fit (LIGOF)\n\n::: {.r-stack}\n\n::: {.absolute left=0 top=70}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/mult_bern2.png){width=960}\n:::\n:::\n\n:::\n\n:::: {.absolute left=580 top=70}\n\n::: {.fragment fragment-index=1 .fade-out}\nConsider instead the fit of the lower dimensional marginals.\n\n- **Univariate**:  $\\ \\dot\\pi_i := \\Pr(y_i = 1)$\n\n- **Bivariate**:  $\\ \\dot\\pi_{ij} := \\Pr(y_i = 1, y_j=1)$\n\n- Collectively:\n$$\n\\bpi_2 = \\begin{pmatrix}\n\\dot\\bpi_1 \\\\\n\\dot\\bpi_2 \\\\\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\dot\\pi_1, \\dots, \\dot\\pi_p)^\\top \\\\\n\\big(\\dot\\pi_{ij}\\big)_{i<j} \\\\\n\\end{pmatrix}\n$$\nThis is of dimensions $S=p + p(p-1)/2$.\n\n:::\n\n::::\n\n\n::: {.absolute .fragment  fragment-index=1 .fade-in left=0 top=70}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/mult_bern3.png){width=960}\n:::\n:::\n\n:::\n\n::: {.absolute .fragment .fade-in left=0 top=70}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/mult_bern4.png){width=960}\n:::\n:::\n\n:::\n\n:::\n\n## Transformation\n\nDefine $T_2: \\mathbb{R}^R \\to \\mathbb{R}^S$ such that $\\bpi \\mapsto \\bpi_2$.\nTo illustrate, consider $p=3$ ($R=2^3=8$ and $S=3+3=6$):\n\n$$\n\\myoverbrace{\n\\left(\n\\begin{array}{c}\n\\dot\\pi_1 \\\\\n\\dot\\pi_2 \\\\\n\\dot\\pi_3 \\\\\n\\hdashline\n\\dot\\pi_{12} \\\\\n\\dot\\pi_{13} \\\\\n\\dot\\pi_{23} \\\\\n\\end{array} \\right)\n\\vphantom{\n\\begin{array}{c}\n\\pi_{000} \\\\\n\\pi_{100} \\\\\n\\pi_{010} \\\\\n\\pi_{001} \\\\\n\\pi_{110} \\\\\n\\pi_{101} \\\\\n\\pi_{011} \\\\\n\\pi_{111} \\\\\n\\end{array}\n}\n}{\\bpi_2}\n=\n\\myoverbrace{\n\\left(\n\\begin{array}{cccccccc}\n0 & 1 & 0 & 0 & 1 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 0 & 1 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 \\\\\n\\hdashline\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 \\\\\n\\end{array} \\right)\n\\vphantom{\n\\begin{array}{c}\n\\pi_{000} \\\\\n\\pi_{100} \\\\\n\\pi_{010} \\\\\n\\pi_{001} \\\\\n\\pi_{110} \\\\\n\\pi_{101} \\\\\n\\pi_{011} \\\\\n\\pi_{111} \\\\\n\\end{array}\n}\n}{T_2}\n\\\n\\myoverbrace{\n\\left(\n\\begin{array}{c}\n\\pi_{000} \\\\\n\\pi_{100} \\\\\n\\pi_{010} \\\\\n\\pi_{001} \\\\\n\\pi_{110} \\\\\n\\pi_{101} \\\\\n\\pi_{011} \\\\\n\\pi_{111} \\\\\n\\end{array} \\right)\n}{\\bpi}\n$$\n\n::: {.aside}\nSee @reiser1996analysis and @maydeu2005limited.\n:::\n\n## Some theory {.scrollable}\n\nConsider the residuals $\\hat\\be_2 = \\bp_2 - \\bpi_2(\\mlepl)$. What is its distribution?\n\n<!-- $\\sqrt n (\\bp - \\bpi) \\xrightarrow{\\text D} \\N_R(\\bzero, \\bSigma)$ [CLT].  -->\n\n<!-- - $\\sqrt n (\\bp_2 - \\bpi_2) \\xrightarrow{\\text D} \\N_S(\\bzero, \\bSigma_2)$ follows from the CLT, where $\\bSigma_2 = T_2\\bSigma T_2^\\top$.  -->\n\n<!-- - Taylor expand MPLE and score function: -->\n$$\n\\begin{aligned}\n\\hat\\be_2 \n= \\bp_2 - \\bpi_2(\\mlepl) \n&\\approx \\bp_2 - \\bpi_2(\\btheta) - \\bDelta_2(\\mlepl - \\btheta) \\\\\n&\\approx \\bp_2 - \\bpi_2(\\btheta) - \\bDelta_2\\cH(\\btheta)^{-1}\\nabla\\pl(\\btheta)  \\\\\n&= \\bp_2 - \\bpi_2(\\btheta) - \\bDelta_2 \\cH(\\btheta)^{-1} \\bB(\\btheta)  \\big(\\bp_2 - \\bpi_2(\\btheta) \\big) \\\\\n&= \\left( \\bI - \\bDelta_2\\cH(\\btheta)^{-1} \\bB(\\btheta)  \\right) \\left( \\bp_2 - \\bpi_2(\\btheta) \\right) \n\\end{aligned}\n$$\nTherefore, $\\sqrt n \\hat\\be_2 \\xrightarrow{\\text D} {\\N}_S\\left(\\bzero, \\bOmega_2\\right)$ as $n\\to\\infty$, where\n$$\n\\bOmega_2 = \\left( \\bI - \\bDelta_2\\cH(\\btheta)^{-1} \\bB(\\btheta)  \\right) \\bSigma_2 \\left( \\bI - \\bDelta_2\\cH(\\btheta)^{-1} \\bB(\\btheta)  \\right)^\\top\n$$\n\n- $\\bSigma_2 = \\bT_2\\bSigma\\bT_2^\\top$ (uni \\& bivariate multinomial matrix);\n- $\\bDelta_2 = \\bT_2 \\big(\\partial\\pi_r(\\btheta) / \\partial\\theta_k \\big)_{r,k}$ (uni \\& bivariate derivatives);\n- $\\cH(\\btheta)$ is the sensitivity matrix; and\n- $\\bB(\\btheta)$ is some transformation matrix dependent on $\\btheta$.\n\n## Distribution of test statistics\n\nLIGOF test statistics generally take the quadratic form \n$$\nX^2  = n \\hat\\be_2^\\top \\hat\\bXi \\hat\\be_2,\n$$\nwhere $\\bXi(\\hat\\btheta) =: \\hat\\bXi \\xrightarrow{\\text P} \\bXi$ is some $S\\times S$ weight matrix. \nGenerally, $X^2$ is reffered to a chi square distribution under $H_0$, because\n$$\nX^2 \\xrightarrow{\\text D} \\sum_{s=1}^S \\delta_s\\chi^2_1 \\quad \\text{as} \\quad n\\to\\infty,\n$$\nwhere the $\\delta_s$ are the eigenvalues of $\\bM = \\bOmega_2\\bXi$. \n\n1. If $\\bM$ is idempotent, then the chi square is exact.\n2. Otherwise, it is a sum of scaled chi squares.\n\n\n<!-- - **Wald test**. Set $\\bXi=\\bOmega_2^+$, the Moore-Penrose generalised inverse of $\\bOmega_2$. Then $X^2$ -->\n\n## Test statistics used\n\n::: columns\n\n::: {.column width=28%}\n<br><br><br><br>\n\n::: {.callout-note appearance=\"simple\"}\n\n[$$\\begin{gathered}X^2  = n \\hat\\be_2^\\top \\hat\\bXi \\hat\\be_2 \\\\\\sqrt n \\hat\\be_2 \\approx {\\N}_S (\\bzero, \\hat\\bOmega_2)\\end{gathered}$$]{.ubdblue}\n\n:::\n:::\n\n::: {.column width=6%}\n:::\n\n::: {.column width=62%}\n<br>\n\n|   | Name         | $\\bXi$                              | D.f.  |\n|---|--------------|-------------------------------------|-------|\n| 1 | Wald         | $\\bOmega_2^+$                       | $S-m$ |\n| 2 | Wald (VCF)   | $\\bXi\\bOmega_2\\bXi$                 | $S-m$ |\n| 3 | Wald (Diag.) | $\\diag(\\bOmega_2)^{-1}$             | est.  |\n| 4 | Pearson      | $\\diag(\\bpi_2)^{-1}$               | est.  |\n| 5 | RSS          | $\\mathbf I$                         | est.  |\n| 6 | Multinomial  | $\\diag(\\bpi_2) - \\bpi_2\\bpi_2^\\top$ | est.  |\n|   |              |                                     |       |\n\n: {.table-ubd}\n:::\n\n:::\n\n\n\n\n\n\n::: aside\n1--@reiser1996analysis; 2--@maydeu2005limited; 4--@bartholomew2002goodness;<br>5,6--@maydeu2008overview.\n:::\n\n# Simulation results\n\n## Informative sampling\n\n- Check bias, coverage, and SD/SE of the estimators\n\n## `{lavaan}`\n\n## Educational survey\n\n- Inspect Type I error rates\n- Power of tests\n\n# Summary\n\n## Conclusions\n\n## References {.appendix}",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}